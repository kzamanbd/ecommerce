import os
from skpy import Skype

# Retrieve environment variables
author = os.environ.get("AUTHOR_NAME")
username = os.environ.get("SKYPE_USERNAME")
password = os.environ.get("SKYPE_PASSWORD")
release_notes = os.environ.get("RELEASE_NOTES")

# Define the Skype recipient and group IDs
recipient_id = "live:.cid.a47b92b06acd5a39"
group_id = "19:1e55bc9219844d01a3b27253a2f78652@thread.skype"

# Create the message to be sent
message = f"Hello! This is an automated message generated by a Skype bot and triggered by a GitHub Action.\n\Released By: {author}\n\nRelease Notes:\n{release_notes}"

try:
    # Initialize the Skype instance
    skype = Skype(username, password)
    
    # Send the message to the group
    chat = skype.chats.chat(group_id)
    chat.sendMsg(message)
    print(message)

except Exception as e:
    print(f"Failed to send message: {e}")
